{% macro categoryItem(item, level) %}
    {% import _self as self %}
    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="{{ item.title|default('') }}">
        <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapse_{{ item.id }}" data-parent="#menu">
            <i class="{{ item.icon|default('') }}"></i>
            <span class="nav-link-text">{{ item.title|default('') }}</span>
        </a>
        <ul class="{% if level|default(2) == 2 %}sidenav-second-level{% elseif level|default(2) == 3 %}sidenav-third-level{% endif %}  collapse" id="collapse_{{ item.id }}">
            {% if item.children is defined and item.children|length %}
                {% for child in item.children %}
                    {% if child.type == 'group' %}
                        {% if child.display is not defined or (child.display is defined and child.display == true) %}
                            {{ self.categoryItem(child, level|default(2) + 1) }}
                        {% endif %}
                    {% elseif child.type == 'link' %}
                        {% if child.display is not defined or (child.display is defined and child.display == true) %}
                            {{ self.linkItem(child) }}
                        {% endif %}
                    {% endif %}
                {% endfor %}
            {% endif %}
        </ul>
    </li>
{% endmacro %}
{% macro linkItem(item) %}
    {% import _self as self %}
    <li class="nav-item {% if app.request.get('page') == item.href %}active{% endif %}" data-toggle="tooltip" data-placement="right" title="{{ item.title|default('')|striptags }}">
        <a class="nav-link" href="{{ path('panel', {'page': item.href}) }}">
            <i class="{{ item.icon|default('') }}"></i>
            <span class="nav-link-text">{{ item.title|default('')|raw }}</span>
        </a>
    </li>
{% endmacro %}
{% from _self import categoryItem %}
{% from _self import linkItem %}

<!DOCTYPE html>
<html lang="{{ app.request.getLocale() }}">
<head>
    <!-- Title -->
    <title>{% block title %}OrbitronDev{% endblock %}</title>

    <!-- Required Meta Tags Always Come First -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="description" content="{% block description %}The official site of OrbitronDev. Containing all projects and everything about us.{% endblock %}" />
    <meta name="author" content="OrbitronDev" />
    <meta name="publisher" content="OrbitronDev" />
    <meta name="copyright" content="OrbitronDev &copy; 2013-2017" />
    <meta name="keywords" content="" />
    <meta name="audience" content="Alle" />
    <meta name="robots" content="INDEX,FOLLOW" />

    <!-- Favicon -->
    {% include '_favicon.html.twig' %}

    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans%3A400%2C300%2C500%2C600%2C700" />

    <!-- CSS Global Compulsory -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.2/css/bootstrap.min.css" />

    <!-- CSS Implementing Plugins -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.4/cookieconsent.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.css" />

    <!-- CSS Admin -->
    <link rel="stylesheet" href="https://web-assets.orbitrondev.org/vendor/sb-admin/css/sb-admin.min.css" />

    <!-- CSS Customization -->
    {% block stylesheets %}{% endblock %}

    <!-- JS Global Compulsory -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body class="fixed-nav sticky-footer bg-dark" id="page-top">
{% block navigation %}
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
        <a class="navbar-brand" href="{{ path('panel', {'page': 'home'}) }}">{{ 'panel.nav.title'|trans }}</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="{{ 'panel.nav.toggle'|trans }}">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav navbar-sidenav" id="menu">
                {% for item in view_navigation %}
                    {% if item.type == 'group' %}
                        {% if item.display is not defined or (item.display is defined and item.display == true) %}
                            {{ categoryItem(item, 2) }}
                        {% endif %}
                    {% elseif item.type == 'link' %}
                        {% if item.display is not defined or (item.display is defined and item.display == true) %}
                            {{ linkItem(item) }}
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </ul>
            <ul class="navbar-nav sidenav-toggler">
                <li class="nav-item">
                    <a class="nav-link text-center" id="sidenavToggler">
                        <i class="fa fa-fw fa-angle-left"></i>
                    </a>
                </li>
            </ul>
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle mr-lg-2" id="userDropdown" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-fw fa-user"></i>
                        <span class="d-lg-none">{{ 'panel.nav_link.user'|trans }}</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                        <a class="dropdown-item" href="{{ path('panel', {'page': 'profile'}) }}">{{ 'panel.nav_link.settings'|trans }}</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="{{ path('logout') }}"><i class="fa fa-fw fa-sign-out"></i> {{ 'panel.nav_link.logout'|trans }}</a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
{% endblock %}

<div class="content-wrapper">
    {% for message in app.session.flashbag.get('successful') %}
        <div class="container-fluid">
            <div id="successful" class="alert alert-success alert-dismissible mb-3" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">{{ 'panel.message.close'|trans }}</span></button>
                {{ message|trans }}
            </div>
        </div>
    {% endfor %}
    {% for message in app.session.flashbag.get('failed') %}
        <div class="container-fluid">
            <div id="failed" class="alert alert-danger alert-dismissible mb-3" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">{{ 'panel.message.close'|trans }}</span></button>
                {{ message|trans }}
            </div>
        </div>
    {% endfor %}
    {% block content %}
        <div class="container-fluid mb-3">
            {{ view_body|raw }}
        </div>
        <footer class="sticky-footer">
            <div class="container">
                <div class="text-center">
                    <small>{{ 'panel.copyright'|trans }}</small>
                </div>
            </div>
        </footer>
        <!-- Scroll to Top Button-->
        <a class="scroll-to-top rounded" href="#page-top">
            <i class="fa fa-angle-up"></i>
        </a>
    {% endblock %}
</div>

<!-- JS Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        };
        i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-69484706-1', 'auto');
    ga('send', 'pageview');
</script>

<!-- JS Global Compulsory -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.2/js/bootstrap.bundle.min.js"></script>

<!-- JS Implementing Plugins -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.4/cookieconsent.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/smoothscroll/1.4.6/SmoothScroll.min.js"></script>

<!-- JS Admin -->
<script src="https://web-assets.orbitrondev.org/vendor/sb-admin/js/sb-admin.min.js"></script>

<!-- JS Plugins Init. -->
<script>
    $(document).ready(function() {
        window.cookieconsent.initialise({
            "palette": {
                "popup": {
                    "background": "#252e39"
                },
                "button": {
                    "background": "#14a7d0"
                }
            },

            onInitialise: function (status) {
                var type = this.options.type;
                var didConsent = this.hasConsented();
                if (type === 'opt-in' && didConsent) {
                    // enable cookies
                }
                if (type === 'opt-out' && !didConsent) {
                    // disable cookies
                }
            },

            onStatusChange: function(status, chosenBefore) {
                var type = this.options.type;
                var didConsent = this.hasConsented();
                if (type === 'opt-in' && didConsent) {
                    // enable cookies
                }
                if (type === 'opt-out' && !didConsent) {
                    // disable cookies
                }
            },

            onRevokeChoice: function() {
                var type = this.options.type;
                if (type === 'opt-in') {
                    // disable cookies
                }
                if (type === 'opt-out') {
                    // enable cookies
                }
            },
            law: {
                regionalLaw: false
            },
            location: true
        });
    });
</script>
{% block javascripts %}{% endblock %}
<!--[if lt IE 9]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
<![endif]-->
</body>
</html>
